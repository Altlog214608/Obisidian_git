# 검사 및 훈련 시나리오
tags: #검사 #훈련 #향기검사

## 🧪 검사 종류

- 역치 검사 (Threshold)
- 식별 검사 (Discrimination)
- 인지 검사 (Identification)

## 🎯 검사 시나리오 공통 흐름

1. Start → WaitReady → Proceed
2. TryScent → 응답선택 → Confirm
3. 결과 저장 → 점수 계산 → 엑셀 출력



# 🧠 인지검사(testIdentification) 선택지 클릭 흐름 정리

  

## ✅ 1. 전체 검사 흐름 요약

  

- `uiTestIdentificationStart()` 실행 후:

  - 인지 검사 화면이 시작됨

  - 현재 문제에 해당하는 이미지, 선택지 등이 렌더링

  - `pg_scent` 프로그레스바가 동작하며 검사 진행

  

---

  

## ✅ 2. 선택지 클릭 시 이미지/스타일 변화

  

### 📌 관련 함수

  

- `uiTestIdentificationResponseChoice1`

- `uiTestIdentificationResponseChoice2`

- `uiTestIdentificationResponseChoice3`

- `uiTestIdentificationResponseChoice4`

  

```python

def uiTestIdentificationResponseChoice1(self):

    if dsTestID.id_temp_response != dsTestID.id_test_data[dsTestID.id_test_index]['choice1']:

        dsTestID.id_temp_response = dsTestID.id_test_data[dsTestID.id_test_index]['choice1']

        self.checkResponseIdentification(1)

        self.selectResponseIdentification()

    else:

        dsTestID.id_temp_response = ""

        self.checkResponseIdentification(0)

        self.unselectResponseIdentification()

```

  

### 💡 동작 설명

  

- 사용자가 버튼을 클릭하면 `dsTestID.id_temp_response`에 선택값 저장

- `checkResponseIdentification(number)`에서 **UI 강조(이미지/스타일)** 적용

  

```python

def checkResponseIdentification(self, number):

    if number == 1:

        self.ui_test_identification_response.pb_check_1.setStyleSheet(dsBtnImg['check'])

        # 나머지는 'null' 스타일로 초기화

    # 2, 3, 4도 동일 패턴

```

  

- `setStyleSheet()` 또는 `setPixmap()` 등을 통해 시각적으로 선택 강조

  

---

  

## ✅ 3. 선택 정보 저장 및 전송 처리

  

### 📌 처리 흐름

  

1. 사용자가 선택 후 ‘다음’ 버튼 클릭 (`pb_next`)

2. 다음 함수 호출:

```python

def uiTestIdentificationResponseNext(self):

    self.confirmResponseIdentification()

    self.uiTestIdentificationProceed()

```

  

3. `confirmResponseIdentification()`에서 실제 데이터 저장:

```python

def confirmResponseIdentification(self):

    self.saveTestDataIdentification("주관식X", dsTestID.id_temp_response)

    self.checkResponseIdentification(0)

    self.uiDlgHide(self.ui_test_identification_response)

```

  

4. 결과는 리스트에 저장됨:

  

```python

def saveTestDataIdentification(self, str_response, choice_response):

    if dsTestID.id_test_data[dsTestID.id_test_index]['answer'] == str_response:

        is_str_correct = 1

    else:

        is_str_correct = 0

  

    if dsTestID.id_test_data[dsTestID.id_test_index]['answer'] == choice_response:

        is_choice_correct = 1

    else:

        is_choice_correct = 0

  

    dsTestID.id_results.append([

        (dsTestID.id_test_index + 1),

        dsTestID.id_test_data[dsTestID.id_test_index]['answer'],

        choice_response,

        is_choice_correct,

        str_response,

        is_str_correct,

    ])

```

  

- `dsTestID.id_results`에 저장된 값은 이후 결과 확인/엑셀 저장 등에 사용됨

  

---

  

## ✅ 요약 정리

  

| 구분             | 동작 설명 |

|------------------|-----------|

| 선택지 클릭       | 콜백 함수(`uiTestIdentificationResponseChoiceX`)에서 임시 값 저장 |

| UI 강조 처리      | `checkResponseIdentification()` 함수로 버튼 스타일 변경 |

| 결과 저장 시점    | ‘다음’ 버튼 클릭 시 `confirmResponseIdentification()` 호출 |

| 데이터 저장 구조 | `dsTestID.id_results` 리스트에 [문항번호, 정답, 응답, 정오판정] 저장 |

| 전송 시점        | 실시간 하드웨어 전송은 없음. 완료 후 결과 저장/엑셀 기록 등에서 처리 |

  

---

  

## ✅ 시각적 흐름도 요약

  

```

선택지 클릭

   ↓

uiTestIdentificationResponseChoiceX()

   ↓

임시 응답 저장 (dsTestID.id_temp_response)

   ↓

UI 스타일 강조 (checkResponseIdentification)

   ↓

[사용자 '다음' 클릭]

   ↓

confirmResponseIdentification()

   ↓

saveTestDataIdentification() → 응답 저장

```

  

---

  

### 🔎 필요 시 더 파고들 수 있는 지점

- `dsTestID.id_test_data`와 `id_results`의 전체 구조

- `pb_next` 버튼 시그널 연결 위치

- 선택지 이미지 파일 교체 방식(`setPixmap` 등)

- 엑셀/DB 저장까지의 전체 결과 저장 흐름

