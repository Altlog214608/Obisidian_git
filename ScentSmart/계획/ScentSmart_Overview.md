# ScentSmart.py 전체 구조 및 기능 분석

  

`ScentSmart.py`는 PySide6 (Qt for Python) 기반의 디지털 후각 검사 및 향기 발산 제어 시스템의 핵심 코드입니다.

  

## 1. 주요 기능 및 목적

  

- 디지털 후각 검사 및 향기 발산 제어 시스템

- 후각 역치 검사, 식별 검사, 인지 검사, 자가 훈련 기능 제공

- 시리얼 통신 기반 향기 발산 장치 제어

- 검사 결과를 엑셀로 저장 및 시각화 (차트 포함)

- 검사 진행 상태 UI로 표시

- 로그인 및 설정 관리

  

## 2. 주요 구조

  

### 2.1 UiDlg 클래스

  

- PySide6의 `QWidget` 상속

- 다양한 검사/훈련/설정/결과 UI 로딩 및 이벤트 연결

- 시리얼 통신 설정 및 데이터 송수신 관리

- 검사 진행 로직, 응답 처리 및 결과 저장 포함

  

### 2.2 시리얼 통신

  

- `serial` 라이브러리 및 `dsSerial.SerialReadThread` 사용

- Signal/Slot 방식의 비동기 통신

- `dsComm`, `dsSetting`을 통한 명령 생성 및 전송

  

### 2.3 검사 종류

  

- 역치 검사 (Threshold Test)

- 식별 검사 (Discrimination Test)

- 인지 검사 (Identification Test)

- 자가 훈련 (ST), 식별 훈련 (ID)

  

### 2.4 검사 상태 및 UI

  

- 진행 단계 표시, 응답 저장, 정답 비교

- Progress bar, 사운드 안내, UI 업데이트

- Timer 기반 시간 기록 및 UI 동기화

  

### 2.5 결과 저장 및 보고서

  

- `xlsxwriter`로 엑셀 파일 및 차트 저장

- JSON 기반 설정 파일 입출력

- 결과 보고서 생성 및 사용자 식별 정보 포함

  

### 2.6 유저 관리

  

- 이름/성별/나이 관리 및 결과 식별용 저장

- 로그인 및 비밀번호 오류 횟수 카운팅

  

## 3. 주요 외부 모듈

  

| 모듈 | 역할 |

|------|------|

| PySide6 | GUI 및 이벤트 처리 |

| serial | 시리얼 통신 |

| json | 설정파일/암호 관리 |

| xlsxwriter | 엑셀 저장 및 차트 생성 |

| dsSerial | 시리얼 포트 연결 및 수신 스레드 |

| dsComm | 명령 생성 함수 |

| dsSetting | 파라미터 저장소 |

| dsSound, dsText | 사운드 및 텍스트 관리 |

| dsTest, dsTestTH, dsTestDC, dsTestID | 검사 상태 저장소 |

| dsTrainST, dsTrainID | 훈련 상태 저장소 |

| dsUiChartWidget | 차트 위젯 처리 |

  

## 4. 기능 흐름 요약

  

1. 프로그램 실행 → `UiDlg` 초기화 및 메인 UI 표시

2. 로그인 후 검사 메뉴 진입

3. 검사 종류 선택 → 가이드 → 검사 진행 UI

4. 검사 시작 → 시리얼 명령 전송, 응답 UI 처리

5. 응답 저장 및 다음 문제 진행

6. 검사 종료 → 결과 표시 → 엑셀 저장 가능

  

## 5. 특징

  

- UI 다이얼로그 다중 전환 (`uiDlgChange` 등)

- 세밀한 시리얼 제어 및 파라미터 처리

- 직관적 피드백 (사운드, 진행바, 시각 효과)

- 결과 저장 체계적 구현

  

## 6. 결론

  

`ScentSmart.py`는 PySide6 기반의 고도화된 후각 검사 GUI 애플리케이션으로,

사용자 응답 처리부터 시리얼 하드웨어 제어, 결과 저장 및 시각화까지 전반을 담당합니다.